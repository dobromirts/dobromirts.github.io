"use strict";(self.webpackChunkapp_lob=self.webpackChunkapp_lob||[]).push([[356],{3356:(Qe,ne,j)=>{j.d(ne,{M:()=>Ke});var i,M=(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),D=function(i){function t(e,r){var n=this,c=this.constructor.prototype;return(n=i.call(this,e)||this).statusCode=r,n.__proto__=c,n}return M(t,i),t}(Error),B=function(i){function t(e){void 0===e&&(e="A timeout occurred.");var o=this,n=this.constructor.prototype;return(o=i.call(this,e)||this).__proto__=n,o}return M(t,i),t}(Error),R=function(i){function t(e){void 0===e&&(e="An abort occurred.");var o=this,n=this.constructor.prototype;return(o=i.call(this,e)||this).__proto__=n,o}return M(t,i),t}(Error),F=Object.assign||function(i){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(i[o]=t[o]);return i},G=function i(t,e,r){this.statusCode=t,this.statusText=e,this.content=r},X=function(){function i(){}return i.prototype.get=function(t,e){return this.send(F({},e,{method:"GET",url:t}))},i.prototype.post=function(t,e){return this.send(F({},e,{method:"POST",url:t}))},i.prototype.delete=function(t,e){return this.send(F({},e,{method:"DELETE",url:t}))},i.prototype.getCookieString=function(t){return""},i}(),l=(()=>(function(i){i[i.Trace=0]="Trace",i[i.Debug=1]="Debug",i[i.Information=2]="Information",i[i.Warning=3]="Warning",i[i.Error=4]="Error",i[i.Critical=5]="Critical",i[i.None=6]="None"}(l||(l={})),l))(),V=function(){function i(){}return i.prototype.log=function(t,e){},i.instance=new i,i}(),re=Object.assign||function(i){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(i[o]=t[o]);return i},y=function(){function i(){}return i.isRequired=function(t,e){if(null==t)throw new Error("The '"+e+"' argument is required.")},i.isNotEmpty=function(t,e){if(!t||t.match(/^\s*$/))throw new Error("The '"+e+"' argument should not be empty.")},i.isIn=function(t,e,r){if(!(t in e))throw new Error("Unknown "+r+" value: "+t+".")},i}(),C=function(){function i(){}return Object.defineProperty(i,"isBrowser",{get:function(){return"object"==typeof window},enumerable:!0,configurable:!0}),Object.defineProperty(i,"isWebWorker",{get:function(){return"object"==typeof self&&"importScripts"in self},enumerable:!0,configurable:!0}),Object.defineProperty(i,"isNode",{get:function(){return!this.isBrowser&&!this.isWebWorker},enumerable:!0,configurable:!0}),i}();function x(i,t){var e="";return z(i)?(e="Binary data of length "+i.byteLength,t&&(e+=". Content: '"+function ce(i){var t=new Uint8Array(i),e="";return t.forEach(function(r){e+="0x"+(r<16?"0":"")+r.toString(16)+" "}),e.substr(0,e.length-1)}(i)+"'")):"string"==typeof i&&(e="String data of length "+i.length,t&&(e+=". Content: '"+i+"'")),e}function z(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&"ArrayBuffer"===i.constructor.name)}function K(i,t,e,r,o,n,c,a,u){return function(i,t,e,r){return new(e||(e=Promise))(function(o,n){function c(s){try{u(r.next(s))}catch(h){n(h)}}function a(s){try{u(r.throw(s))}catch(h){n(h)}}function u(s){s.done?o(s.value):new e(function(h){h(s.value)}).then(c,a)}u((r=r.apply(i,[])).next())})}(this,0,void 0,function(){var s,h,f,d,b,p;return function(i,t){var r,o,n,c,e={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return c={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function a(s){return function(h){return function u(s){if(r)throw new TypeError("Generator is already executing.");for(;e;)try{if(r=1,o&&(n=2&s[0]?o.return:s[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,s[1])).done)return n;switch(o=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,o=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(!(n=(n=e.trys).length>0&&n[n.length-1])&&(6===s[0]||2===s[0])){e=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){e.label=s[1];break}if(6===s[0]&&e.label<n[1]){e.label=n[1],n=s;break}if(n&&e.label<n[2]){e.label=n[2],e.ops.push(s);break}n[2]&&e.ops.pop(),e.trys.pop();continue}s=t.call(i,e)}catch(h){s=[6,h],o=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,h])}}}(this,function(L){switch(L.label){case 0:return h={},o?[4,o()]:[3,2];case 1:(f=L.sent())&&((s={}).Authorization="Bearer "+f,h=s),L.label=2;case 2:return d=T(),h[d[0]]=d[1],i.log(l.Trace,"("+t+" transport) sending data. "+x(n,c)+"."),b=z(n)?"arraybuffer":"text",[4,e.post(r,{content:n,headers:re({},h,u),responseType:b,withCredentials:a})];case 3:return p=L.sent(),i.log(l.Trace,"("+t+" transport) request complete. Response status: "+p.statusCode+"."),[2]}})})}var ue=function(){function i(t,e){this.subject=t,this.observer=e}return i.prototype.dispose=function(){var t=this.subject.observers.indexOf(this.observer);t>-1&&this.subject.observers.splice(t,1),0===this.subject.observers.length&&this.subject.cancelCallback&&this.subject.cancelCallback().catch(function(e){})},i}(),W=function(){function i(t){this.minimumLogLevel=t,this.outputConsole=console}return i.prototype.log=function(t,e){if(t>=this.minimumLogLevel)switch(t){case l.Critical:case l.Error:this.outputConsole.error("["+(new Date).toISOString()+"] "+l[t]+": "+e);break;case l.Warning:this.outputConsole.warn("["+(new Date).toISOString()+"] "+l[t]+": "+e);break;case l.Information:this.outputConsole.info("["+(new Date).toISOString()+"] "+l[t]+": "+e);break;default:this.outputConsole.log("["+(new Date).toISOString()+"] "+l[t]+": "+e)}},i}();function T(){var i="X-SignalR-User-Agent";return C.isNode&&(i="User-Agent"),[i,le("5.0.17",he(),C.isNode?"NodeJS":"Browser",fe())]}function le(i,t,e,r){var o="Microsoft SignalR/",n=i.split(".");return o+=n[0]+"."+n[1],o+=" ("+i+"; ",o+=t&&""!==t?t+"; ":"Unknown OS; ",o+=""+e,(o+=r?"; "+r:"; Unknown Runtime Version")+")"}function he(){if(!C.isNode)return"";switch(process.platform){case"win32":return"Windows NT";case"darwin":return"macOS";case"linux":return"Linux";default:return process.platform}}function fe(){if(C.isNode)return process.versions.node}var pe=function(){var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ge=Object.assign||function(i){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(i[o]=t[o]);return i},ye=function(i){function t(e){var r=i.call(this)||this;if(r.logger=e,typeof fetch>"u"){var o=require;r.jar=new(o("tough-cookie").CookieJar),r.fetchType=o("node-fetch"),r.fetchType=o("fetch-cookie")(r.fetchType,r.jar),r.abortControllerType=o("abort-controller")}else r.fetchType=fetch.bind(self),r.abortControllerType=AbortController;return r}return pe(t,i),t.prototype.send=function(e){return function(i,t,e,r){return new(e||(e=Promise))(function(o,n){function c(s){try{u(r.next(s))}catch(h){n(h)}}function a(s){try{u(r.throw(s))}catch(h){n(h)}}function u(s){s.done?o(s.value):new e(function(h){h(s.value)}).then(c,a)}u((r=r.apply(i,[])).next())})}(this,0,void 0,function(){var r,o,n,a,u,s,h,f=this;return function(i,t){var r,o,n,c,e={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return c={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function a(s){return function(h){return function u(s){if(r)throw new TypeError("Generator is already executing.");for(;e;)try{if(r=1,o&&(n=2&s[0]?o.return:s[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,s[1])).done)return n;switch(o=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,o=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(!(n=(n=e.trys).length>0&&n[n.length-1])&&(6===s[0]||2===s[0])){e=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){e.label=s[1];break}if(6===s[0]&&e.label<n[1]){e.label=n[1],n=s;break}if(n&&e.label<n[2]){e.label=n[2],e.ops.push(s);break}n[2]&&e.ops.pop(),e.trys.pop();continue}s=t.call(i,e)}catch(h){s=[6,h],o=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,h])}}}(this,function(d){switch(d.label){case 0:if(e.abortSignal&&e.abortSignal.aborted)throw new R;if(!e.method)throw new Error("No method defined.");if(!e.url)throw new Error("No url defined.");r=new this.abortControllerType,e.abortSignal&&(e.abortSignal.onabort=function(){r.abort(),o=new R}),n=null,e.timeout&&(n=setTimeout(function(){r.abort(),f.logger.log(l.Warning,"Timeout from HTTP request."),o=new B},e.timeout)),d.label=1;case 1:return d.trys.push([1,3,4,5]),[4,this.fetchType(e.url,{body:e.content,cache:"no-cache",credentials:!0===e.withCredentials?"include":"same-origin",headers:ge({"Content-Type":"text/plain;charset=UTF-8","X-Requested-With":"XMLHttpRequest"},e.headers),method:e.method,mode:"cors",redirect:"manual",signal:r.signal})];case 2:return a=d.sent(),[3,5];case 3:throw u=d.sent(),o||(this.logger.log(l.Warning,"Error from HTTP request. "+u+"."),u);case 4:return n&&clearTimeout(n),e.abortSignal&&(e.abortSignal.onabort=null),[7];case 5:if(!a.ok)throw new D(a.statusText,a.status);return s=function we(i,t){var e;switch(t){case"arraybuffer":e=i.arrayBuffer();break;case"text":default:e=i.text();break;case"blob":case"document":case"json":throw new Error(t+" is not supported.")}return e}(a,e.responseType),[4,s];case 6:return h=d.sent(),[2,new G(a.status,a.statusText,h)]}})})},t.prototype.getCookieString=function(e){var r="";return C.isNode&&this.jar&&this.jar.getCookies(e,function(o,n){return r=n.join("; ")}),r},t}(X),me=function(){var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Se=function(i){function t(e){var r=i.call(this)||this;return r.logger=e,r}return me(t,i),t.prototype.send=function(e){var r=this;return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new R):e.method?e.url?new Promise(function(o,n){var c=new XMLHttpRequest;c.open(e.method,e.url,!0),c.withCredentials=void 0===e.withCredentials||e.withCredentials,c.setRequestHeader("X-Requested-With","XMLHttpRequest"),c.setRequestHeader("Content-Type","text/plain;charset=UTF-8");var a=e.headers;a&&Object.keys(a).forEach(function(u){c.setRequestHeader(u,a[u])}),e.responseType&&(c.responseType=e.responseType),e.abortSignal&&(e.abortSignal.onabort=function(){c.abort(),n(new R)}),e.timeout&&(c.timeout=e.timeout),c.onload=function(){e.abortSignal&&(e.abortSignal.onabort=null),c.status>=200&&c.status<300?o(new G(c.status,c.statusText,c.response||c.responseText)):n(new D(c.statusText,c.status))},c.onerror=function(){r.logger.log(l.Warning,"Error from HTTP request. "+c.status+": "+c.statusText+"."),n(new D(c.statusText,c.status))},c.ontimeout=function(){r.logger.log(l.Warning,"Timeout from HTTP request."),n(new B)},c.send(e.content||"")}):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))},t}(X),Ce=function(){var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ke=function(i){function t(e){var r=i.call(this)||this;if(typeof fetch<"u"||C.isNode)r.httpClient=new ye(e);else{if(!(typeof XMLHttpRequest<"u"))throw new Error("No usable HttpClient found.");r.httpClient=new Se(e)}return r}return Ce(t,i),t.prototype.send=function(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new R):e.method?e.url?this.httpClient.send(e):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))},t.prototype.getCookieString=function(e){return this.httpClient.getCookieString(e)},t}(X),I=function(){function i(){}return i.write=function(t){return""+t+i.RecordSeparator},i.parse=function(t){if(t[t.length-1]!==i.RecordSeparator)throw new Error("Message is incomplete.");var e=t.split(i.RecordSeparator);return e.pop(),e},i.RecordSeparatorCode=30,i.RecordSeparator=String.fromCharCode(i.RecordSeparatorCode),i}(),Ee=function(){function i(){}return i.prototype.writeHandshakeRequest=function(t){return I.write(JSON.stringify(t))},i.prototype.parseHandshakeResponse=function(t){var r,o;if(z(t)||typeof Buffer<"u"&&t instanceof Buffer){var n=new Uint8Array(t);if(-1===(c=n.indexOf(I.RecordSeparatorCode)))throw new Error("Message is incomplete.");var a=c+1;r=String.fromCharCode.apply(null,n.slice(0,a)),o=n.byteLength>a?n.slice(a).buffer:null}else{var c,u=t;if(-1===(c=u.indexOf(I.RecordSeparator)))throw new Error("Message is incomplete.");r=u.substring(0,a=c+1),o=u.length>a?u.substring(a):null}var s=I.parse(r),h=JSON.parse(s[0]);if(h.type)throw new Error("Expected a handshake response from the server.");return[o,h]},i}(),g=(()=>(function(i){i[i.Invocation=1]="Invocation",i[i.StreamItem=2]="StreamItem",i[i.Completion=3]="Completion",i[i.StreamInvocation=4]="StreamInvocation",i[i.CancelInvocation=5]="CancelInvocation",i[i.Ping=6]="Ping",i[i.Close=7]="Close"}(g||(g={})),g))(),Pe=function(){function i(){this.observers=[]}return i.prototype.next=function(t){for(var e=0,r=this.observers;e<r.length;e++)r[e].next(t)},i.prototype.error=function(t){for(var e=0,r=this.observers;e<r.length;e++){var o=r[e];o.error&&o.error(t)}},i.prototype.complete=function(){for(var t=0,e=this.observers;t<e.length;t++){var r=e[t];r.complete&&r.complete()}},i.prototype.subscribe=function(t){return this.observers.push(t),new ue(this,t)},i}(),H=function(i,t,e,r){return new(e||(e=Promise))(function(o,n){function c(s){try{u(r.next(s))}catch(h){n(h)}}function a(s){try{u(r.throw(s))}catch(h){n(h)}}function u(s){s.done?o(s.value):new e(function(h){h(s.value)}).then(c,a)}u((r=r.apply(i,t||[])).next())})},O=function(i,t){var r,o,n,c,e={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return c={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function a(s){return function(h){return function u(s){if(r)throw new TypeError("Generator is already executing.");for(;e;)try{if(r=1,o&&(n=2&s[0]?o.return:s[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,s[1])).done)return n;switch(o=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,o=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(!(n=(n=e.trys).length>0&&n[n.length-1])&&(6===s[0]||2===s[0])){e=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){e.label=s[1];break}if(6===s[0]&&e.label<n[1]){e.label=n[1],n=s;break}if(n&&e.label<n[2]){e.label=n[2],e.ops.push(s);break}n[2]&&e.ops.pop(),e.trys.pop();continue}s=t.call(i,e)}catch(h){s=[6,h],o=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,h])}}},v=(()=>(function(i){i.Disconnected="Disconnected",i.Connecting="Connecting",i.Connected="Connected",i.Disconnecting="Disconnecting",i.Reconnecting="Reconnecting"}(v||(v={})),v))(),De=function(){function i(t,e,r,o){var n=this;this.nextKeepAlive=0,y.isRequired(t,"connection"),y.isRequired(e,"logger"),y.isRequired(r,"protocol"),this.serverTimeoutInMilliseconds=3e4,this.keepAliveIntervalInMilliseconds=15e3,this.logger=e,this.protocol=r,this.connection=t,this.reconnectPolicy=o,this.handshakeProtocol=new Ee,this.connection.onreceive=function(c){return n.processIncomingData(c)},this.connection.onclose=function(c){return n.connectionClosed(c)},this.callbacks={},this.methods={},this.closedCallbacks=[],this.reconnectingCallbacks=[],this.reconnectedCallbacks=[],this.invocationId=0,this.receivedHandshakeResponse=!1,this.connectionState=v.Disconnected,this.connectionStarted=!1,this.cachedPingMessage=this.protocol.writeMessage({type:g.Ping})}return i.create=function(t,e,r,o){return new i(t,e,r,o)},Object.defineProperty(i.prototype,"state",{get:function(){return this.connectionState},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"connectionId",{get:function(){return this.connection&&this.connection.connectionId||null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"baseUrl",{get:function(){return this.connection.baseUrl||""},set:function(t){if(this.connectionState!==v.Disconnected&&this.connectionState!==v.Reconnecting)throw new Error("The HubConnection must be in the Disconnected or Reconnecting state to change the url.");if(!t)throw new Error("The HubConnection url must be a valid url.");this.connection.baseUrl=t},enumerable:!0,configurable:!0}),i.prototype.start=function(){return this.startPromise=this.startWithStateTransitions(),this.startPromise},i.prototype.startWithStateTransitions=function(){return H(this,void 0,void 0,function(){var t;return O(this,function(e){switch(e.label){case 0:if(this.connectionState!==v.Disconnected)return[2,Promise.reject(new Error("Cannot start a HubConnection that is not in the 'Disconnected' state."))];this.connectionState=v.Connecting,this.logger.log(l.Debug,"Starting HubConnection."),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.startInternal()];case 2:return e.sent(),this.connectionState=v.Connected,this.connectionStarted=!0,this.logger.log(l.Debug,"HubConnection connected successfully."),[3,4];case 3:return t=e.sent(),this.connectionState=v.Disconnected,this.logger.log(l.Debug,"HubConnection failed to start successfully because of error '"+t+"'."),[2,Promise.reject(t)];case 4:return[2]}})})},i.prototype.startInternal=function(){return H(this,void 0,void 0,function(){var t,e,r,o=this;return O(this,function(n){switch(n.label){case 0:return this.stopDuringStartError=void 0,this.receivedHandshakeResponse=!1,t=new Promise(function(c,a){o.handshakeResolver=c,o.handshakeRejecter=a}),[4,this.connection.start(this.protocol.transferFormat)];case 1:n.sent(),n.label=2;case 2:return n.trys.push([2,5,,7]),e={protocol:this.protocol.name,version:this.protocol.version},this.logger.log(l.Debug,"Sending handshake request."),[4,this.sendMessage(this.handshakeProtocol.writeHandshakeRequest(e))];case 3:return n.sent(),this.logger.log(l.Information,"Using HubProtocol '"+this.protocol.name+"'."),this.cleanupTimeout(),this.resetTimeoutPeriod(),this.resetKeepAliveInterval(),[4,t];case 4:if(n.sent(),this.stopDuringStartError)throw this.stopDuringStartError;return[3,7];case 5:return r=n.sent(),this.logger.log(l.Debug,"Hub handshake failed with error '"+r+"' during start(). Stopping HubConnection."),this.cleanupTimeout(),this.cleanupPingTimer(),[4,this.connection.stop(r)];case 6:throw n.sent(),r;case 7:return[2]}})})},i.prototype.stop=function(){return H(this,void 0,void 0,function(){var t;return O(this,function(r){switch(r.label){case 0:return t=this.startPromise,this.stopPromise=this.stopInternal(),[4,this.stopPromise];case 1:r.sent(),r.label=2;case 2:return r.trys.push([2,4,,5]),[4,t];case 3:case 4:return r.sent(),[3,5];case 5:return[2]}})})},i.prototype.stopInternal=function(t){return this.connectionState===v.Disconnected?(this.logger.log(l.Debug,"Call to HubConnection.stop("+t+") ignored because it is already in the disconnected state."),Promise.resolve()):this.connectionState===v.Disconnecting?(this.logger.log(l.Debug,"Call to HttpConnection.stop("+t+") ignored because the connection is already in the disconnecting state."),this.stopPromise):(this.connectionState=v.Disconnecting,this.logger.log(l.Debug,"Stopping HubConnection."),this.reconnectDelayHandle?(this.logger.log(l.Debug,"Connection stopped during reconnect delay. Done reconnecting."),clearTimeout(this.reconnectDelayHandle),this.reconnectDelayHandle=void 0,this.completeClose(),Promise.resolve()):(this.cleanupTimeout(),this.cleanupPingTimer(),this.stopDuringStartError=t||new Error("The connection was stopped before the hub handshake could complete."),this.connection.stop(t)))},i.prototype.stream=function(t){for(var e=this,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];var s,n=this.replaceStreamingParams(r),c=n[0],a=n[1],u=this.createStreamInvocation(t,r,a),h=new Pe;return h.cancelCallback=function(){var f=e.createCancelInvocation(u.invocationId);return delete e.callbacks[u.invocationId],s.then(function(){return e.sendWithProtocol(f)})},this.callbacks[u.invocationId]=function(f,d){d?h.error(d):f&&(f.type===g.Completion?f.error?h.error(new Error(f.error)):h.complete():h.next(f.item))},s=this.sendWithProtocol(u).catch(function(f){h.error(f),delete e.callbacks[u.invocationId]}),this.launchStreams(c,s),h},i.prototype.sendMessage=function(t){return this.resetKeepAliveInterval(),this.connection.send(t)},i.prototype.sendWithProtocol=function(t){return this.sendMessage(this.protocol.writeMessage(t))},i.prototype.send=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var o=this.replaceStreamingParams(e),n=o[0],c=o[1],a=this.sendWithProtocol(this.createInvocation(t,e,!0,c));return this.launchStreams(n,a),a},i.prototype.invoke=function(t){for(var e=this,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];var n=this.replaceStreamingParams(r),c=n[0],a=n[1],u=this.createInvocation(t,r,!1,a),s=new Promise(function(h,f){e.callbacks[u.invocationId]=function(m,k){k?f(k):m&&(m.type===g.Completion?m.error?f(new Error(m.error)):h(m.result):f(new Error("Unexpected message type: "+m.type)))};var d=e.sendWithProtocol(u).catch(function(m){f(m),delete e.callbacks[u.invocationId]});e.launchStreams(c,d)});return s},i.prototype.on=function(t,e){!t||!e||(t=t.toLowerCase(),this.methods[t]||(this.methods[t]=[]),-1===this.methods[t].indexOf(e)&&this.methods[t].push(e))},i.prototype.off=function(t,e){if(t){t=t.toLowerCase();var r=this.methods[t];if(r)if(e){var o=r.indexOf(e);-1!==o&&(r.splice(o,1),0===r.length&&delete this.methods[t])}else delete this.methods[t]}},i.prototype.onclose=function(t){t&&this.closedCallbacks.push(t)},i.prototype.onreconnecting=function(t){t&&this.reconnectingCallbacks.push(t)},i.prototype.onreconnected=function(t){t&&this.reconnectedCallbacks.push(t)},i.prototype.processIncomingData=function(t){if(this.cleanupTimeout(),this.receivedHandshakeResponse||(t=this.processHandshakeResponse(t),this.receivedHandshakeResponse=!0),t)for(var r=0,o=this.protocol.parseMessages(t,this.logger);r<o.length;r++){var n=o[r];switch(n.type){case g.Invocation:this.invokeClientMethod(n);break;case g.StreamItem:case g.Completion:var c=this.callbacks[n.invocationId];c&&(n.type===g.Completion&&delete this.callbacks[n.invocationId],c(n));break;case g.Ping:break;case g.Close:this.logger.log(l.Information,"Close message received from server.");var a=n.error?new Error("Server returned an error on close: "+n.error):void 0;!0===n.allowReconnect?this.connection.stop(a):this.stopPromise=this.stopInternal(a);break;default:this.logger.log(l.Warning,"Invalid message type: "+n.type+".")}}this.resetTimeoutPeriod()},i.prototype.processHandshakeResponse=function(t){var e,r,o,n;try{o=(e=this.handshakeProtocol.parseHandshakeResponse(t))[0],r=e[1]}catch(a){this.logger.log(l.Error,n="Error parsing handshake response: "+a);var c=new Error(n);throw this.handshakeRejecter(c),c}if(r.error)throw this.logger.log(l.Error,n="Server returned handshake error: "+r.error),c=new Error(n),this.handshakeRejecter(c),c;return this.logger.log(l.Debug,"Server handshake complete."),this.handshakeResolver(),o},i.prototype.resetKeepAliveInterval=function(){this.connection.features.inherentKeepAlive||(this.nextKeepAlive=(new Date).getTime()+this.keepAliveIntervalInMilliseconds,this.cleanupPingTimer())},i.prototype.resetTimeoutPeriod=function(){var t=this;if(!(this.connection.features&&this.connection.features.inherentKeepAlive||(this.timeoutHandle=setTimeout(function(){return t.serverTimeout()},this.serverTimeoutInMilliseconds),void 0!==this.pingServerHandle))){var e=this.nextKeepAlive-(new Date).getTime();e<0&&(e=0),this.pingServerHandle=setTimeout(function(){return H(t,void 0,void 0,function(){return O(this,function(o){switch(o.label){case 0:if(this.connectionState!==v.Connected)return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.sendMessage(this.cachedPingMessage)];case 2:return o.sent(),[3,4];case 3:return o.sent(),this.cleanupPingTimer(),[3,4];case 4:return[2]}})})},e)}},i.prototype.serverTimeout=function(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))},i.prototype.invokeClientMethod=function(t){var e=this,r=this.methods[t.target.toLowerCase()];if(r){try{r.forEach(function(n){return n.apply(e,t.arguments)})}catch(n){this.logger.log(l.Error,"A callback for the method "+t.target.toLowerCase()+" threw error '"+n+"'.")}if(t.invocationId){var o="Server requested a response, which is not supported in this version of the client.";this.logger.log(l.Error,o),this.stopPromise=this.stopInternal(new Error(o))}}else this.logger.log(l.Warning,"No client method with the name '"+t.target+"' found.")},i.prototype.connectionClosed=function(t){this.logger.log(l.Debug,"HubConnection.connectionClosed("+t+") called while in state "+this.connectionState+"."),this.stopDuringStartError=this.stopDuringStartError||t||new Error("The underlying connection was closed before the hub handshake could complete."),this.handshakeResolver&&this.handshakeResolver(),this.cancelCallbacksWithError(t||new Error("Invocation canceled due to the underlying connection being closed.")),this.cleanupTimeout(),this.cleanupPingTimer(),this.connectionState===v.Disconnecting?this.completeClose(t):this.connectionState===v.Connected&&this.reconnectPolicy?this.reconnect(t):this.connectionState===v.Connected&&this.completeClose(t)},i.prototype.completeClose=function(t){var e=this;if(this.connectionStarted){this.connectionState=v.Disconnected,this.connectionStarted=!1;try{this.closedCallbacks.forEach(function(r){return r.apply(e,[t])})}catch(r){this.logger.log(l.Error,"An onclose callback called with error '"+t+"' threw error '"+r+"'.")}}},i.prototype.reconnect=function(t){return H(this,void 0,void 0,function(){var e,r,o,n,c,a=this;return O(this,function(u){switch(u.label){case 0:if(e=Date.now(),r=0,o=void 0!==t?t:new Error("Attempting to reconnect due to a unknown error."),null===(n=this.getNextRetryDelay(r++,0,o)))return this.logger.log(l.Debug,"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt."),this.completeClose(t),[2];if(this.connectionState=v.Reconnecting,this.logger.log(l.Information,t?"Connection reconnecting because of error '"+t+"'.":"Connection reconnecting."),this.onreconnecting){try{this.reconnectingCallbacks.forEach(function(s){return s.apply(a,[t])})}catch(s){this.logger.log(l.Error,"An onreconnecting callback called with error '"+t+"' threw error '"+s+"'.")}if(this.connectionState!==v.Reconnecting)return this.logger.log(l.Debug,"Connection left the reconnecting state in onreconnecting callback. Done reconnecting."),[2]}u.label=1;case 1:return null===n?[3,7]:(this.logger.log(l.Information,"Reconnect attempt number "+r+" will start in "+n+" ms."),[4,new Promise(function(s){a.reconnectDelayHandle=setTimeout(s,n)})]);case 2:if(u.sent(),this.reconnectDelayHandle=void 0,this.connectionState!==v.Reconnecting)return this.logger.log(l.Debug,"Connection left the reconnecting state during reconnect delay. Done reconnecting."),[2];u.label=3;case 3:return u.trys.push([3,5,,6]),[4,this.startInternal()];case 4:if(u.sent(),this.connectionState=v.Connected,this.logger.log(l.Information,"HubConnection reconnected successfully."),this.onreconnected)try{this.reconnectedCallbacks.forEach(function(s){return s.apply(a,[a.connection.connectionId])})}catch(s){this.logger.log(l.Error,"An onreconnected callback called with connectionId '"+this.connection.connectionId+"; threw error '"+s+"'.")}return[2];case 5:return c=u.sent(),this.logger.log(l.Information,"Reconnect attempt failed because of error '"+c+"'."),this.connectionState!==v.Reconnecting?(this.logger.log(l.Debug,"Connection moved to the '"+this.connectionState+"' from the reconnecting state during reconnect attempt. Done reconnecting."),this.connectionState===v.Disconnecting&&this.completeClose(),[2]):(o=c instanceof Error?c:new Error(c.toString()),n=this.getNextRetryDelay(r++,Date.now()-e,o),[3,6]);case 6:return[3,1];case 7:return this.logger.log(l.Information,"Reconnect retries have been exhausted after "+(Date.now()-e)+" ms and "+r+" failed attempts. Connection disconnecting."),this.completeClose(),[2]}})})},i.prototype.getNextRetryDelay=function(t,e,r){try{return this.reconnectPolicy.nextRetryDelayInMilliseconds({elapsedMilliseconds:e,previousRetryCount:t,retryReason:r})}catch(o){return this.logger.log(l.Error,"IRetryPolicy.nextRetryDelayInMilliseconds("+t+", "+e+") threw error '"+o+"'."),null}},i.prototype.cancelCallbacksWithError=function(t){var e=this.callbacks;this.callbacks={},Object.keys(e).forEach(function(r){(0,e[r])(null,t)})},i.prototype.cleanupPingTimer=function(){this.pingServerHandle&&(clearTimeout(this.pingServerHandle),this.pingServerHandle=void 0)},i.prototype.cleanupTimeout=function(){this.timeoutHandle&&clearTimeout(this.timeoutHandle)},i.prototype.createInvocation=function(t,e,r,o){if(r)return 0!==o.length?{arguments:e,streamIds:o,target:t,type:g.Invocation}:{arguments:e,target:t,type:g.Invocation};var n=this.invocationId;return this.invocationId++,0!==o.length?{arguments:e,invocationId:n.toString(),streamIds:o,target:t,type:g.Invocation}:{arguments:e,invocationId:n.toString(),target:t,type:g.Invocation}},i.prototype.launchStreams=function(t,e){var r=this;if(0!==t.length){e||(e=Promise.resolve());var o=function(c){t[c].subscribe({complete:function(){e=e.then(function(){return r.sendWithProtocol(r.createCompletionMessage(c))})},error:function(a){var u;u=a instanceof Error?a.message:a&&a.toString?a.toString():"Unknown error",e=e.then(function(){return r.sendWithProtocol(r.createCompletionMessage(c,u))})},next:function(a){e=e.then(function(){return r.sendWithProtocol(r.createStreamItemMessage(c,a))})}})};for(var n in t)o(n)}},i.prototype.replaceStreamingParams=function(t){for(var e=[],r=[],o=0;o<t.length;o++){var n=t[o];if(this.isObservable(n)){var c=this.invocationId;this.invocationId++,e[c]=n,r.push(c.toString()),t.splice(o,1)}}return[e,r]},i.prototype.isObservable=function(t){return t&&t.subscribe&&"function"==typeof t.subscribe},i.prototype.createStreamInvocation=function(t,e,r){var o=this.invocationId;return this.invocationId++,0!==r.length?{arguments:e,invocationId:o.toString(),streamIds:r,target:t,type:g.StreamInvocation}:{arguments:e,invocationId:o.toString(),target:t,type:g.StreamInvocation}},i.prototype.createCancelInvocation=function(t){return{invocationId:t,type:g.CancelInvocation}},i.prototype.createStreamItemMessage=function(t,e){return{invocationId:t,item:e,type:g.StreamItem}},i.prototype.createCompletionMessage=function(t,e,r){return e?{error:e,invocationId:t,type:g.Completion}:{invocationId:t,result:r,type:g.Completion}},i}(),Re=[0,2e3,1e4,3e4,null],Q=function(){function i(t){this.retryDelays=void 0!==t?t.concat([null]):Re}return i.prototype.nextRetryDelayInMilliseconds=function(t){return this.retryDelays[t.previousRetryCount]},i}(),w=(()=>(function(i){i[i.None=0]="None",i[i.WebSockets=1]="WebSockets",i[i.ServerSentEvents=2]="ServerSentEvents",i[i.LongPolling=4]="LongPolling"}(w||(w={})),w))(),S=(()=>(function(i){i[i.Text=1]="Text",i[i.Binary=2]="Binary"}(S||(S={})),S))(),xe=function(){function i(){this.isAborted=!1,this.onabort=null}return i.prototype.abort=function(){this.isAborted||(this.isAborted=!0,this.onabort&&this.onabort())},Object.defineProperty(i.prototype,"signal",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"aborted",{get:function(){return this.isAborted},enumerable:!0,configurable:!0}),i}(),Y=Object.assign||function(i){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(i[o]=t[o]);return i},_=function(i,t,e,r){return new(e||(e=Promise))(function(o,n){function c(s){try{u(r.next(s))}catch(h){n(h)}}function a(s){try{u(r.throw(s))}catch(h){n(h)}}function u(s){s.done?o(s.value):new e(function(h){h(s.value)}).then(c,a)}u((r=r.apply(i,t||[])).next())})},A=function(i,t){var r,o,n,c,e={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return c={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function a(s){return function(h){return function u(s){if(r)throw new TypeError("Generator is already executing.");for(;e;)try{if(r=1,o&&(n=2&s[0]?o.return:s[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,s[1])).done)return n;switch(o=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,o=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(!(n=(n=e.trys).length>0&&n[n.length-1])&&(6===s[0]||2===s[0])){e=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){e.label=s[1];break}if(6===s[0]&&e.label<n[1]){e.label=n[1],n=s;break}if(n&&e.label<n[2]){e.label=n[2],e.ops.push(s);break}n[2]&&e.ops.pop(),e.trys.pop();continue}s=t.call(i,e)}catch(h){s=[6,h],o=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,h])}}},$=function(){function i(t,e,r,o,n,c){this.httpClient=t,this.accessTokenFactory=e,this.logger=r,this.pollAbort=new xe,this.logMessageContent=o,this.withCredentials=n,this.headers=c,this.running=!1,this.onreceive=null,this.onclose=null}return Object.defineProperty(i.prototype,"pollAborted",{get:function(){return this.pollAbort.aborted},enumerable:!0,configurable:!0}),i.prototype.connect=function(t,e){return _(this,void 0,void 0,function(){var r,o,a,u,s,h,f;return A(this,function(d){switch(d.label){case 0:if(y.isRequired(t,"url"),y.isRequired(e,"transferFormat"),y.isIn(e,S,"transferFormat"),this.url=t,this.logger.log(l.Trace,"(LongPolling transport) Connecting."),e===S.Binary&&typeof XMLHttpRequest<"u"&&"string"!=typeof(new XMLHttpRequest).responseType)throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");return o=T(),a=Y(((r={})[o[0]]=o[1],r),this.headers),u={abortSignal:this.pollAbort.signal,headers:a,timeout:1e5,withCredentials:this.withCredentials},e===S.Binary&&(u.responseType="arraybuffer"),[4,this.getAccessToken()];case 1:return s=d.sent(),this.updateHeaderToken(u,s),h=t+"&_="+Date.now(),this.logger.log(l.Trace,"(LongPolling transport) polling: "+h+"."),[4,this.httpClient.get(h,u)];case 2:return 200!==(f=d.sent()).statusCode?(this.logger.log(l.Error,"(LongPolling transport) Unexpected response code: "+f.statusCode+"."),this.closeError=new D(f.statusText||"",f.statusCode),this.running=!1):this.running=!0,this.receiving=this.poll(this.url,u),[2]}})})},i.prototype.getAccessToken=function(){return _(this,void 0,void 0,function(){return A(this,function(t){switch(t.label){case 0:return this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:return[2,t.sent()];case 2:return[2,null]}})})},i.prototype.updateHeaderToken=function(t,e){t.headers||(t.headers={}),e?t.headers.Authorization="Bearer "+e:t.headers.Authorization&&delete t.headers.Authorization},i.prototype.poll=function(t,e){return _(this,void 0,void 0,function(){var r,o,n,c;return A(this,function(a){switch(a.label){case 0:a.trys.push([0,,8,9]),a.label=1;case 1:return this.running?[4,this.getAccessToken()]:[3,7];case 2:r=a.sent(),this.updateHeaderToken(e,r),a.label=3;case 3:return a.trys.push([3,5,,6]),o=t+"&_="+Date.now(),this.logger.log(l.Trace,"(LongPolling transport) polling: "+o+"."),[4,this.httpClient.get(o,e)];case 4:return 204===(n=a.sent()).statusCode?(this.logger.log(l.Information,"(LongPolling transport) Poll terminated by server."),this.running=!1):200!==n.statusCode?(this.logger.log(l.Error,"(LongPolling transport) Unexpected response code: "+n.statusCode+"."),this.closeError=new D(n.statusText||"",n.statusCode),this.running=!1):n.content?(this.logger.log(l.Trace,"(LongPolling transport) data received. "+x(n.content,this.logMessageContent)+"."),this.onreceive&&this.onreceive(n.content)):this.logger.log(l.Trace,"(LongPolling transport) Poll timed out, reissuing."),[3,6];case 5:return c=a.sent(),this.running?c instanceof B?this.logger.log(l.Trace,"(LongPolling transport) Poll timed out, reissuing."):(this.closeError=c,this.running=!1):this.logger.log(l.Trace,"(LongPolling transport) Poll errored after shutdown: "+c.message),[3,6];case 6:return[3,1];case 7:return[3,9];case 8:return this.logger.log(l.Trace,"(LongPolling transport) Polling complete."),this.pollAborted||this.raiseOnClose(),[7];case 9:return[2]}})})},i.prototype.send=function(t){return _(this,void 0,void 0,function(){return A(this,function(e){return this.running?[2,K(this.logger,"LongPolling",this.httpClient,this.url,this.accessTokenFactory,t,this.logMessageContent,this.withCredentials,this.headers)]:[2,Promise.reject(new Error("Cannot send until the transport is connected"))]})})},i.prototype.stop=function(){return _(this,void 0,void 0,function(){var t,e,n,c;return A(this,function(a){switch(a.label){case 0:this.logger.log(l.Trace,"(LongPolling transport) Stopping polling."),this.running=!1,this.pollAbort.abort(),a.label=1;case 1:return a.trys.push([1,,5,6]),[4,this.receiving];case 2:return a.sent(),this.logger.log(l.Trace,"(LongPolling transport) sending DELETE request to "+this.url+"."),t={},e=T(),t[e[0]]=e[1],n={headers:Y({},t,this.headers),withCredentials:this.withCredentials},[4,this.getAccessToken()];case 3:return c=a.sent(),this.updateHeaderToken(n,c),[4,this.httpClient.delete(this.url,n)];case 4:return a.sent(),this.logger.log(l.Trace,"(LongPolling transport) DELETE request sent."),[3,6];case 5:return this.logger.log(l.Trace,"(LongPolling transport) Stop finished."),this.raiseOnClose(),[7];case 6:return[2]}})})},i.prototype.raiseOnClose=function(){if(this.onclose){var t="(LongPolling transport) Firing onclose event.";this.closeError&&(t+=" Error: "+this.closeError),this.logger.log(l.Trace,t),this.onclose(this.closeError)}},i}(),He=Object.assign||function(i){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(i[o]=t[o]);return i},Z=function(i,t,e,r){return new(e||(e=Promise))(function(o,n){function c(s){try{u(r.next(s))}catch(h){n(h)}}function a(s){try{u(r.throw(s))}catch(h){n(h)}}function u(s){s.done?o(s.value):new e(function(h){h(s.value)}).then(c,a)}u((r=r.apply(i,t||[])).next())})},q=function(i,t){var r,o,n,c,e={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return c={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function a(s){return function(h){return function u(s){if(r)throw new TypeError("Generator is already executing.");for(;e;)try{if(r=1,o&&(n=2&s[0]?o.return:s[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,s[1])).done)return n;switch(o=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,o=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(!(n=(n=e.trys).length>0&&n[n.length-1])&&(6===s[0]||2===s[0])){e=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){e.label=s[1];break}if(6===s[0]&&e.label<n[1]){e.label=n[1],n=s;break}if(n&&e.label<n[2]){e.label=n[2],e.ops.push(s);break}n[2]&&e.ops.pop(),e.trys.pop();continue}s=t.call(i,e)}catch(h){s=[6,h],o=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,h])}}},Oe=function(){function i(t,e,r,o,n,c,a){this.httpClient=t,this.accessTokenFactory=e,this.logger=r,this.logMessageContent=o,this.withCredentials=c,this.eventSourceConstructor=n,this.headers=a,this.onreceive=null,this.onclose=null}return i.prototype.connect=function(t,e){return Z(this,void 0,void 0,function(){var r,o=this;return q(this,function(n){switch(n.label){case 0:return y.isRequired(t,"url"),y.isRequired(e,"transferFormat"),y.isIn(e,S,"transferFormat"),this.logger.log(l.Trace,"(SSE transport) Connecting."),this.url=t,this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(r=n.sent())&&(t+=(t.indexOf("?")<0?"?":"&")+"access_token="+encodeURIComponent(r)),n.label=2;case 2:return[2,new Promise(function(c,a){var u=!1;if(e===S.Text){var s;if(C.isBrowser||C.isWebWorker)s=new o.eventSourceConstructor(t,{withCredentials:o.withCredentials});else{var h=o.httpClient.getCookieString(t),f={};f.Cookie=h;var d=T();f[d[0]]=d[1],s=new o.eventSourceConstructor(t,{withCredentials:o.withCredentials,headers:He({},f,o.headers)})}try{s.onmessage=function(b){if(o.onreceive)try{o.logger.log(l.Trace,"(SSE transport) data received. "+x(b.data,o.logMessageContent)+"."),o.onreceive(b.data)}catch(p){return void o.close(p)}},s.onerror=function(b){var p=new Error(b.data||"Error occurred");u?o.close(p):a(p)},s.onopen=function(){o.logger.log(l.Information,"SSE connected to "+o.url),o.eventSource=s,u=!0,c()}}catch(b){return void a(b)}}else a(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"))})]}})})},i.prototype.send=function(t){return Z(this,void 0,void 0,function(){return q(this,function(e){return this.eventSource?[2,K(this.logger,"SSE",this.httpClient,this.url,this.accessTokenFactory,t,this.logMessageContent,this.withCredentials,this.headers)]:[2,Promise.reject(new Error("Cannot send until the transport is connected"))]})})},i.prototype.stop=function(){return this.close(),Promise.resolve()},i.prototype.close=function(t){this.eventSource&&(this.eventSource.close(),this.eventSource=void 0,this.onclose&&this.onclose(t))},i}(),_e=Object.assign||function(i){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(i[o]=t[o]);return i},We=function(){function i(t,e,r,o,n,c){this.logger=r,this.accessTokenFactory=e,this.logMessageContent=o,this.webSocketConstructor=n,this.httpClient=t,this.onreceive=null,this.onclose=null,this.headers=c}return i.prototype.connect=function(t,e){return function(i,t,e,r){return new(e||(e=Promise))(function(o,n){function c(s){try{u(r.next(s))}catch(h){n(h)}}function a(s){try{u(r.throw(s))}catch(h){n(h)}}function u(s){s.done?o(s.value):new e(function(h){h(s.value)}).then(c,a)}u((r=r.apply(i,[])).next())})}(this,0,void 0,function(){var r,o=this;return function(i,t){var r,o,n,c,e={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return c={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function a(s){return function(h){return function u(s){if(r)throw new TypeError("Generator is already executing.");for(;e;)try{if(r=1,o&&(n=2&s[0]?o.return:s[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,s[1])).done)return n;switch(o=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,o=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(!(n=(n=e.trys).length>0&&n[n.length-1])&&(6===s[0]||2===s[0])){e=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){e.label=s[1];break}if(6===s[0]&&e.label<n[1]){e.label=n[1],n=s;break}if(n&&e.label<n[2]){e.label=n[2],e.ops.push(s);break}n[2]&&e.ops.pop(),e.trys.pop();continue}s=t.call(i,e)}catch(h){s=[6,h],o=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,h])}}}(this,function(n){switch(n.label){case 0:return y.isRequired(t,"url"),y.isRequired(e,"transferFormat"),y.isIn(e,S,"transferFormat"),this.logger.log(l.Trace,"(WebSockets transport) Connecting."),this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(r=n.sent())&&(t+=(t.indexOf("?")<0?"?":"&")+"access_token="+encodeURIComponent(r)),n.label=2;case 2:return[2,new Promise(function(c,a){t=t.replace(/^http/,"ws");var u,s=o.httpClient.getCookieString(t),h=!1;if(C.isNode){var f={},d=T();f[d[0]]=d[1],s&&(f.Cookie=""+s),u=new o.webSocketConstructor(t,void 0,{headers:_e({},f,o.headers)})}u||(u=new o.webSocketConstructor(t)),e===S.Binary&&(u.binaryType="arraybuffer"),u.onopen=function(b){o.logger.log(l.Information,"WebSocket connected to "+t+"."),o.webSocket=u,h=!0,c()},u.onerror=function(b){var p;p=typeof ErrorEvent<"u"&&b instanceof ErrorEvent?b.error:new Error("There was an error with the transport."),a(p)},u.onmessage=function(b){if(o.logger.log(l.Trace,"(WebSockets transport) data received. "+x(b.data,o.logMessageContent)+"."),o.onreceive)try{o.onreceive(b.data)}catch(p){return void o.close(p)}},u.onclose=function(b){if(h)o.close(b);else{var p;p=typeof ErrorEvent<"u"&&b instanceof ErrorEvent?b.error:new Error("There was an error with the transport."),a(p)}}})]}})})},i.prototype.send=function(t){return this.webSocket&&this.webSocket.readyState===this.webSocketConstructor.OPEN?(this.logger.log(l.Trace,"(WebSockets transport) sending data. "+x(t,this.logMessageContent)+"."),this.webSocket.send(t),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")},i.prototype.stop=function(){return this.webSocket&&this.close(void 0),Promise.resolve()},i.prototype.close=function(t){this.webSocket&&(this.webSocket.onclose=function(){},this.webSocket.onmessage=function(){},this.webSocket.onerror=function(){},this.webSocket.close(),this.webSocket=void 0),this.logger.log(l.Trace,"(WebSockets transport) socket closed."),this.onclose&&(!this.isCloseEvent(t)||!1!==t.wasClean&&1e3===t.code?t instanceof Error?this.onclose(t):this.onclose():this.onclose(new Error("WebSocket closed with status code: "+t.code+" ("+t.reason+").")))},i.prototype.isCloseEvent=function(t){return t&&"boolean"==typeof t.wasClean&&"number"==typeof t.code},i}(),Ne=Object.assign||function(i){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(i[o]=t[o]);return i},P=function(i,t,e,r){return new(e||(e=Promise))(function(o,n){function c(s){try{u(r.next(s))}catch(h){n(h)}}function a(s){try{u(r.throw(s))}catch(h){n(h)}}function u(s){s.done?o(s.value):new e(function(h){h(s.value)}).then(c,a)}u((r=r.apply(i,t||[])).next())})},E=function(i,t){var r,o,n,c,e={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return c={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function a(s){return function(h){return function u(s){if(r)throw new TypeError("Generator is already executing.");for(;e;)try{if(r=1,o&&(n=2&s[0]?o.return:s[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,s[1])).done)return n;switch(o=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,o=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(!(n=(n=e.trys).length>0&&n[n.length-1])&&(6===s[0]||2===s[0])){e=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){e.label=s[1];break}if(6===s[0]&&e.label<n[1]){e.label=n[1],n=s;break}if(n&&e.label<n[2]){e.label=n[2],e.ops.push(s);break}n[2]&&e.ops.pop(),e.trys.pop();continue}s=t.call(i,e)}catch(h){s=[6,h],o=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,h])}}},Ue=function(){function i(t,e){if(void 0===e&&(e={}),this.stopPromiseResolver=function(){},this.features={},this.negotiateVersion=1,y.isRequired(t,"url"),this.logger=function ae(i){return void 0===i?new W(l.Information):null===i?V.instance:i.log?i:new W(i)}(e.logger),this.baseUrl=this.resolveUrl(t),(e=e||{}).logMessageContent=void 0!==e.logMessageContent&&e.logMessageContent,"boolean"!=typeof e.withCredentials&&void 0!==e.withCredentials)throw new Error("withCredentials option was not a 'boolean' or 'undefined' value");e.withCredentials=void 0===e.withCredentials||e.withCredentials;var r=null,o=null;if(C.isNode){var n=require;r=n("ws"),o=n("eventsource")}!C.isNode&&typeof WebSocket<"u"&&!e.WebSocket?e.WebSocket=WebSocket:C.isNode&&!e.WebSocket&&r&&(e.WebSocket=r),!C.isNode&&typeof EventSource<"u"&&!e.EventSource?e.EventSource=EventSource:C.isNode&&!e.EventSource&&typeof o<"u"&&(e.EventSource=o),this.httpClient=e.httpClient||new ke(this.logger),this.connectionState="Disconnected",this.connectionStarted=!1,this.options=e,this.onreceive=null,this.onclose=null}return i.prototype.start=function(t){return P(this,void 0,void 0,function(){var e;return E(this,function(r){switch(r.label){case 0:return y.isIn(t=t||S.Binary,S,"transferFormat"),this.logger.log(l.Debug,"Starting connection with transfer format '"+S[t]+"'."),"Disconnected"!==this.connectionState?[2,Promise.reject(new Error("Cannot start an HttpConnection that is not in the 'Disconnected' state."))]:(this.connectionState="Connecting",this.startInternalPromise=this.startInternal(t),[4,this.startInternalPromise]);case 1:return r.sent(),"Disconnecting"!==this.connectionState?[3,3]:(this.logger.log(l.Error,e="Failed to start the HttpConnection before stop() was called."),[4,this.stopPromise]);case 2:return r.sent(),[2,Promise.reject(new Error(e))];case 3:if("Connected"!==this.connectionState)return this.logger.log(l.Error,e="HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!"),[2,Promise.reject(new Error(e))];r.label=4;case 4:return this.connectionStarted=!0,[2]}})})},i.prototype.send=function(t){return"Connected"!==this.connectionState?Promise.reject(new Error("Cannot send data if the connection is not in the 'Connected' State.")):(this.sendQueue||(this.sendQueue=new Me(this.transport)),this.sendQueue.send(t))},i.prototype.stop=function(t){return P(this,void 0,void 0,function(){var e=this;return E(this,function(r){switch(r.label){case 0:return"Disconnected"===this.connectionState?(this.logger.log(l.Debug,"Call to HttpConnection.stop("+t+") ignored because the connection is already in the disconnected state."),[2,Promise.resolve()]):"Disconnecting"===this.connectionState?(this.logger.log(l.Debug,"Call to HttpConnection.stop("+t+") ignored because the connection is already in the disconnecting state."),[2,this.stopPromise]):(this.connectionState="Disconnecting",this.stopPromise=new Promise(function(o){e.stopPromiseResolver=o}),[4,this.stopInternal(t)]);case 1:return r.sent(),[4,this.stopPromise];case 2:return r.sent(),[2]}})})},i.prototype.stopInternal=function(t){return P(this,void 0,void 0,function(){var r;return E(this,function(o){switch(o.label){case 0:this.stopError=t,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.startInternalPromise];case 2:case 3:return o.sent(),[3,4];case 4:if(!this.transport)return[3,9];o.label=5;case 5:return o.trys.push([5,7,,8]),[4,this.transport.stop()];case 6:return o.sent(),[3,8];case 7:return r=o.sent(),this.logger.log(l.Error,"HttpConnection.transport.stop() threw error '"+r+"'."),this.stopConnection(),[3,8];case 8:return this.transport=void 0,[3,10];case 9:this.logger.log(l.Debug,"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed."),o.label=10;case 10:return[2]}})})},i.prototype.startInternal=function(t){return P(this,void 0,void 0,function(){var e,r,o,n,c,a;return E(this,function(u){switch(u.label){case 0:e=this.baseUrl,this.accessTokenFactory=this.options.accessTokenFactory,u.label=1;case 1:return u.trys.push([1,12,,13]),this.options.skipNegotiation?this.options.transport!==w.WebSockets?[3,3]:(this.transport=this.constructTransport(w.WebSockets),[4,this.startTransport(e,t)]):[3,5];case 2:return u.sent(),[3,4];case 3:throw new Error("Negotiation can only be skipped when using the WebSocket transport directly.");case 4:return[3,11];case 5:r=null,o=0,n=function(){var s;return E(this,function(h){switch(h.label){case 0:return[4,c.getNegotiationResponse(e)];case 1:if(r=h.sent(),"Disconnecting"===c.connectionState||"Disconnected"===c.connectionState)throw new Error("The connection was stopped during negotiation.");if(r.error)throw new Error(r.error);if(r.ProtocolVersion)throw new Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");return r.url&&(e=r.url),r.accessToken&&(s=r.accessToken,c.accessTokenFactory=function(){return s}),o++,[2]}})},c=this,u.label=6;case 6:return[5,n()];case 7:u.sent(),u.label=8;case 8:if(r.url&&o<100)return[3,6];u.label=9;case 9:if(100===o&&r.url)throw new Error("Negotiate redirection limit exceeded.");return[4,this.createTransport(e,this.options.transport,r,t)];case 10:u.sent(),u.label=11;case 11:return this.transport instanceof $&&(this.features.inherentKeepAlive=!0),"Connecting"===this.connectionState&&(this.logger.log(l.Debug,"The HttpConnection connected successfully."),this.connectionState="Connected"),[3,13];case 12:return a=u.sent(),this.logger.log(l.Error,"Failed to start the connection: "+a),this.connectionState="Disconnected",this.transport=void 0,this.stopPromiseResolver(),[2,Promise.reject(a)];case 13:return[2]}})})},i.prototype.getNegotiationResponse=function(t){return P(this,void 0,void 0,function(){var e,r,o,a,u,s,h;return E(this,function(f){switch(f.label){case 0:return e={},this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(r=f.sent())&&(e.Authorization="Bearer "+r),f.label=2;case 2:o=T(),e[o[0]]=o[1],a=this.resolveNegotiateUrl(t),this.logger.log(l.Debug,"Sending negotiation request: "+a+"."),f.label=3;case 3:return f.trys.push([3,5,,6]),[4,this.httpClient.post(a,{content:"",headers:Ne({},e,this.options.headers),withCredentials:this.options.withCredentials})];case 4:return 200!==(u=f.sent()).statusCode?[2,Promise.reject(new Error("Unexpected status code returned from negotiate '"+u.statusCode+"'"))]:((!(s=JSON.parse(u.content)).negotiateVersion||s.negotiateVersion<1)&&(s.connectionToken=s.connectionId),[2,s]);case 5:return h=f.sent(),this.logger.log(l.Error,"Failed to complete negotiation with the server: "+h),[2,Promise.reject(h)];case 6:return[2]}})})},i.prototype.createConnectUrl=function(t,e){return e?t+(-1===t.indexOf("?")?"?":"&")+"id="+e:t},i.prototype.createTransport=function(t,e,r,o){return P(this,void 0,void 0,function(){var n,c,u,s,h,f,d,m,k;return E(this,function(p){switch(p.label){case 0:return n=this.createConnectUrl(t,r.connectionToken),this.isITransport(e)?(this.logger.log(l.Debug,"Connection was provided an instance of ITransport, using that directly."),this.transport=e,[4,this.startTransport(n,o)]):[3,2];case 1:return p.sent(),this.connectionId=r.connectionId,[2];case 2:c=[],u=r,s=0,h=r.availableTransports||[],p.label=3;case 3:return s<h.length?(d=this.resolveTransportOrError(f=h[s],e,o))instanceof Error?(c.push(f.transport+" failed: "+d),[3,12]):[3,4]:[3,13];case 4:if(!this.isITransport(d))return[3,12];if(this.transport=d,u)return[3,9];p.label=5;case 5:return p.trys.push([5,7,,8]),[4,this.getNegotiationResponse(t)];case 6:return u=p.sent(),[3,8];case 7:return m=p.sent(),[2,Promise.reject(m)];case 8:n=this.createConnectUrl(t,u.connectionToken),p.label=9;case 9:return p.trys.push([9,11,,12]),[4,this.startTransport(n,o)];case 10:return p.sent(),this.connectionId=u.connectionId,[2];case 11:return k=p.sent(),this.logger.log(l.Error,"Failed to start the transport '"+f.transport+"': "+k),u=void 0,c.push(f.transport+" failed: "+k),"Connecting"!==this.connectionState?(this.logger.log(l.Debug,"Failed to select transport before stop() was called."),[2,Promise.reject(new Error("Failed to select transport before stop() was called."))]):[3,12];case 12:return s++,[3,3];case 13:return c.length>0?[2,Promise.reject(new Error("Unable to connect to the server with any of the available transports. "+c.join(" ")))]:[2,Promise.reject(new Error("None of the transports supported by the client are supported by the server."))]}})})},i.prototype.constructTransport=function(t){switch(t){case w.WebSockets:if(!this.options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new We(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1,this.options.WebSocket,this.options.headers||{});case w.ServerSentEvents:if(!this.options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new Oe(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1,this.options.EventSource,this.options.withCredentials,this.options.headers||{});case w.LongPolling:return new $(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1,this.options.withCredentials,this.options.headers||{});default:throw new Error("Unknown transport: "+t+".")}},i.prototype.startTransport=function(t,e){var r=this;return this.transport.onreceive=this.onreceive,this.transport.onclose=function(o){return r.stopConnection(o)},this.transport.connect(t,e)},i.prototype.resolveTransportOrError=function(t,e,r){var o=w[t.transport];if(null==o)return this.logger.log(l.Debug,"Skipping transport '"+t.transport+"' because it is not supported by this client."),new Error("Skipping transport '"+t.transport+"' because it is not supported by this client.");if(!function Le(i,t){return!i||0!=(t&i)}(e,o))return this.logger.log(l.Debug,"Skipping transport '"+w[o]+"' because it was disabled by the client."),new Error("'"+w[o]+"' is disabled by the client.");if(!(t.transferFormats.map(function(c){return S[c]}).indexOf(r)>=0))return this.logger.log(l.Debug,"Skipping transport '"+w[o]+"' because it does not support the requested transfer format '"+S[r]+"'."),new Error("'"+w[o]+"' does not support "+S[r]+".");if(o===w.WebSockets&&!this.options.WebSocket||o===w.ServerSentEvents&&!this.options.EventSource)return this.logger.log(l.Debug,"Skipping transport '"+w[o]+"' because it is not supported in your environment.'"),new Error("'"+w[o]+"' is not supported in your environment.");this.logger.log(l.Debug,"Selecting transport '"+w[o]+"'.");try{return this.constructTransport(o)}catch(c){return c}},i.prototype.isITransport=function(t){return t&&"object"==typeof t&&"connect"in t},i.prototype.stopConnection=function(t){var e=this;if(this.logger.log(l.Debug,"HttpConnection.stopConnection("+t+") called while in state "+this.connectionState+"."),this.transport=void 0,t=this.stopError||t,this.stopError=void 0,"Disconnected"!==this.connectionState){if("Connecting"===this.connectionState)throw this.logger.log(l.Warning,"Call to HttpConnection.stopConnection("+t+") was ignored because the connection is still in the connecting state."),new Error("HttpConnection.stopConnection("+t+") was called while the connection is still in the connecting state.");if("Disconnecting"===this.connectionState&&this.stopPromiseResolver(),t?this.logger.log(l.Error,"Connection disconnected with error '"+t+"'."):this.logger.log(l.Information,"Connection disconnected."),this.sendQueue&&(this.sendQueue.stop().catch(function(r){e.logger.log(l.Error,"TransportSendQueue.stop() threw error '"+r+"'.")}),this.sendQueue=void 0),this.connectionId=void 0,this.connectionState="Disconnected",this.connectionStarted){this.connectionStarted=!1;try{this.onclose&&this.onclose(t)}catch(r){this.logger.log(l.Error,"HttpConnection.onclose("+t+") threw error '"+r+"'.")}}}else this.logger.log(l.Debug,"Call to HttpConnection.stopConnection("+t+") was ignored because the connection is already in the disconnected state.")},i.prototype.resolveUrl=function(t){if(0===t.lastIndexOf("https://",0)||0===t.lastIndexOf("http://",0))return t;if(!C.isBrowser||!window.document)throw new Error("Cannot resolve '"+t+"'.");var e=window.document.createElement("a");return e.href=t,this.logger.log(l.Information,"Normalizing '"+t+"' to '"+e.href+"'."),e.href},i.prototype.resolveNegotiateUrl=function(t){var e=t.indexOf("?"),r=t.substring(0,-1===e?t.length:e);return"/"!==r[r.length-1]&&(r+="/"),r+="negotiate",-1===(r+=-1===e?"":t.substring(e)).indexOf("negotiateVersion")&&(r+=-1===e?"?":"&",r+="negotiateVersion="+this.negotiateVersion),r},i}(),Me=function(){function i(t){this.transport=t,this.buffer=[],this.executing=!0,this.sendBufferedData=new N,this.transportResult=new N,this.sendLoopPromise=this.sendLoop()}return i.prototype.send=function(t){return this.bufferData(t),this.transportResult||(this.transportResult=new N),this.transportResult.promise},i.prototype.stop=function(){return this.executing=!1,this.sendBufferedData.resolve(),this.sendLoopPromise},i.prototype.bufferData=function(t){if(this.buffer.length&&typeof this.buffer[0]!=typeof t)throw new Error("Expected data to be of type "+typeof this.buffer+" but was of type "+typeof t);this.buffer.push(t),this.sendBufferedData.resolve()},i.prototype.sendLoop=function(){return P(this,void 0,void 0,function(){var t,e,r;return E(this,function(o){switch(o.label){case 0:return[4,this.sendBufferedData.promise];case 1:if(o.sent(),!this.executing)return this.transportResult&&this.transportResult.reject("Connection stopped."),[3,6];this.sendBufferedData=new N,t=this.transportResult,this.transportResult=void 0,e="string"==typeof this.buffer[0]?this.buffer.join(""):i.concatBuffers(this.buffer),this.buffer.length=0,o.label=2;case 2:return o.trys.push([2,4,,5]),[4,this.transport.send(e)];case 3:return o.sent(),t.resolve(),[3,5];case 4:return r=o.sent(),t.reject(r),[3,5];case 5:return[3,0];case 6:return[2]}})})},i.concatBuffers=function(t){for(var e=t.map(function(u){return u.byteLength}).reduce(function(u,s){return u+s}),r=new Uint8Array(e),o=0,n=0,c=t;n<c.length;n++){var a=c[n];r.set(new Uint8Array(a),o),o+=a.byteLength}return r.buffer},i}(),N=function(){function i(){var t=this;this.promise=new Promise(function(e,r){var o;return t.resolver=(o=[e,r])[0],t.rejecter=o[1],o})}return i.prototype.resolve=function(){this.resolver()},i.prototype.reject=function(t){this.rejecter(t)},i}(),Fe=function(){function i(){this.name="json",this.version=1,this.transferFormat=S.Text}return i.prototype.parseMessages=function(t,e){if("string"!=typeof t)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!t)return[];null===e&&(e=V.instance);for(var o=[],n=0,c=I.parse(t);n<c.length;n++){var u=JSON.parse(c[n]);if("number"!=typeof u.type)throw new Error("Invalid payload.");switch(u.type){case g.Invocation:this.isInvocationMessage(u);break;case g.StreamItem:this.isStreamItemMessage(u);break;case g.Completion:this.isCompletionMessage(u);break;case g.Ping:case g.Close:break;default:e.log(l.Information,"Unknown message type '"+u.type+"' ignored.");continue}o.push(u)}return o},i.prototype.writeMessage=function(t){return I.write(JSON.stringify(t))},i.prototype.isInvocationMessage=function(t){this.assertNotEmptyString(t.target,"Invalid payload for Invocation message."),void 0!==t.invocationId&&this.assertNotEmptyString(t.invocationId,"Invalid payload for Invocation message.")},i.prototype.isStreamItemMessage=function(t){if(this.assertNotEmptyString(t.invocationId,"Invalid payload for StreamItem message."),void 0===t.item)throw new Error("Invalid payload for StreamItem message.")},i.prototype.isCompletionMessage=function(t){if(t.result&&t.error)throw new Error("Invalid payload for Completion message.");!t.result&&t.error&&this.assertNotEmptyString(t.error,"Invalid payload for Completion message."),this.assertNotEmptyString(t.invocationId,"Invalid payload for Completion message.")},i.prototype.assertNotEmptyString=function(t,e){if("string"!=typeof t||""===t)throw new Error(e)},i}(),te=Object.assign||function(i){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(i[o]=t[o]);return i},Xe={trace:l.Trace,debug:l.Debug,info:l.Information,information:l.Information,warn:l.Warning,warning:l.Warning,error:l.Error,critical:l.Critical,none:l.None},ze=function(){function i(){}return i.prototype.configureLogging=function(t){if(y.isRequired(t,"logging"),function Je(i){return void 0!==i.log}(t))this.logger=t;else if("string"==typeof t){var e=function Ve(i){var t=Xe[i.toLowerCase()];if(typeof t<"u")return t;throw new Error("Unknown log level: "+i)}(t);this.logger=new W(e)}else this.logger=new W(t);return this},i.prototype.withUrl=function(t,e){return y.isRequired(t,"url"),y.isNotEmpty(t,"url"),this.url=t,this.httpConnectionOptions=te({},this.httpConnectionOptions,"object"==typeof e?e:{transport:e}),this},i.prototype.withHubProtocol=function(t){return y.isRequired(t,"protocol"),this.protocol=t,this},i.prototype.withAutomaticReconnect=function(t){if(this.reconnectPolicy)throw new Error("A reconnectPolicy has already been set.");return this.reconnectPolicy=t?Array.isArray(t)?new Q(t):t:new Q,this},i.prototype.build=function(){var t=this.httpConnectionOptions||{};if(void 0===t.logger&&(t.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");var e=new Ue(this.url,t);return De.create(e,this.logger||V.instance,this.protocol||new Fe,this.reconnectPolicy)},i}(),Ge=j(591),U=j(6913),J=j(5062);let Ke=(()=>{class i{constructor(e){this.zone=e,this.startConnection=(r=500,o=1e3,n=!1,c=!0)=>{this.hubConnection=(new ze).configureLogging(l.Trace).withUrl("https://www.infragistics.com/angular-apis/webapi/streamHub").build(),this.hubConnection.start().then(()=>{this.hasRemoteConnection=!0,this.registerSignalEvents(),this.broadcastParams(r,o,n,c)}).catch(()=>{this.hasRemoteConnection=!1,this._timer&&this.stopFeed();const a=U.F7.generateData(o);n?this._timer=setInterval(()=>c?this.updateAllPriceValues(a):this.updateRandomPriceValues(a),r):this.getData(o)})},this.broadcastParams=(r,o,n,c=!0)=>{this.hubConnection.invoke("updateparameters",r,o,n,c).then(()=>console.log("requestLiveData",o)).catch(a=>{console.error(a)})},this.stopLiveData=()=>{this.hasRemoteConnection?this.hubConnection.invoke("StopTimer").catch(r=>console.error(r)):this.stopFeed()},this.data=new Ge.X([])}ngOnDestroy(){this.stopLiveData()}getData(e=10){this.data.next(U.F7.generateData(e))}updateAllPriceValues(e){this.zone.runOutsideAngular(()=>{const r=U.F7.updateAllPrices(e);this.data.next(r)})}updateRandomPriceValues(e){this.zone.runOutsideAngular(()=>{const r=U.F7.updateRandomPrices(e);this.data.next(r)})}stopFeed(){this._timer&&clearInterval(this._timer)}registerSignalEvents(){this.hubConnection.onclose(()=>{this.hasRemoteConnection=!1}),this.hubConnection.on("transferdata",e=>{this.data.next(e)})}}return i.\u0275fac=function(e){return new(e||i)(J.LFG(J.R0b))},i.\u0275prov=J.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})()}}]);